<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>idx_images_minist_digits â€¢ rTorch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="idx_images_minist_digits">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rTorch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9012</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/simple_linear_regression.html">Simple Linear Regression</a>
    </li>
    <li>
      <a href="../articles/linear_regression_rainfall.html">Linear Regregression, rainfall</a>
    </li>
    <li>
      <a href="../articles/linear_regression_rainfall_builtins.html">Linear Regregression, rainfall. PyTorch builtins</a>
    </li>
    <li>
      <a href="../articles/two_layer_neural_network.html">Two Layer Neural Network</a>
    </li>
    <li>
      <a href="../articles/logistic_regression_mnist_digits_idx.html">Logistic Regression, MNIST digits</a>
    </li>
    <li>
      <a href="../articles/idx_images_minist_digits.html">MNIST digits recognition, IDX format</a>
    </li>
    <li>
      <a href="../articles/png_images_mnist_digits.html">MNIST digits recognition, PNG images</a>
    </li>
    <li>
      <a href="../articles/mnist_fashion_inference.html">MNIST Fashion images. Inference and Validation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/f0nzie/rTorch">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>idx_images_minist_digits</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/f0nzie/rTorch/blob/master/vignettes/idx_images_minist_digits.Rmd"><code>vignettes/idx_images_minist_digits.Rmd</code></a></small>
      <div class="hidden name"><code>idx_images_minist_digits.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rTorch)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># these are the equivalents of import module</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">nn          &lt;-<span class="st"> </span>torch<span class="op">$</span>nn</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">transforms  &lt;-<span class="st"> </span>torchvision<span class="op">$</span>transforms</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">dsets       &lt;-<span class="st"> </span>torchvision<span class="op">$</span>datasets</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">builtins    &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/import">import_builtins</a></span>()</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">batch_size_train &lt;-<span class="st">  </span>64L</a></code></pre></div>
<div id="load-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#load-datasets" class="anchor"></a>Load datasets</h2>
<div id="load-training-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#load-training-dataset" class="anchor"></a>Load training dataset</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">local_folder &lt;-<span class="st"> '~/raw_data'</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># this will save the datasets to the local drive</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">train_dataset =<span class="st"> </span>dsets<span class="op">$</span><span class="kw">MNIST</span>(<span class="dt">root=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/file.path">file.path</a></span>(local_folder), </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                            <span class="dt">train=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                            <span class="dt">transform=</span>transforms<span class="op">$</span><span class="kw">ToTensor</span>(),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                            <span class="dt">download=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                            </a>
<a class="sourceLine" id="cb3-8" data-line-number="8">train_dataset</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; Dataset MNIST</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;     Number of datapoints: 60000</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;     Root location: /home/msfz751/raw_data</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;     Split: Train</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">builtins<span class="op">$</span><span class="kw">len</span>(train_dataset)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; [1] 60000</span></a></code></pre></div>
</div>
<div id="introspection" class="section level3">
<h3 class="hasAnchor">
<a href="#introspection" class="anchor"></a>Introspection</h3>
</div>
<div id="class-and-length-of-train_dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#class-and-length-of-train_dataset" class="anchor"></a>Class and length of <code>train_dataset</code>
</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># R</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(train_dataset)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; [1] "torchvision.datasets.mnist.MNIST"         </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; [2] "torchvision.datasets.vision.VisionDataset"</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; [3] "torch.utils.data.dataset.Dataset"         </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; [4] "python.builtin.object"</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(train_dataset)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Python</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">builtins<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/typeof">type</a></span>(train_dataset)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; &lt;class 'torchvision.datasets.mnist.MNIST'&gt;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">builtins<span class="op">$</span><span class="kw">len</span>(train_dataset)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [1] 60000</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_len">py_len</a></span>(train_dataset)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; [1] 60000</span></a></code></pre></div>
<blockquote>
<p>Note that both similar commands produce different results</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(train_dataset)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt;  [1] "class_to_idx"     "classes"          "data"            </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;  [4] "download"         "extra_repr"       "extract_gzip"    </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;  [7] "processed_folder" "raw_folder"       "root"            </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; [10] "target_transform" "targets"          "test_data"       </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [13] "test_file"        "test_labels"      "train"           </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [16] "train_data"       "train_labels"     "training_file"   </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; [19] "transform"        "transforms"       "urls"</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_list_attributes">py_list_attributes</a></span>(train_dataset)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt;  [1] "__add__"                "__class__"             </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;  [3] "__delattr__"            "__dict__"              </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;  [5] "__dir__"                "__doc__"               </span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;  [7] "__eq__"                 "__format__"            </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  [9] "__ge__"                 "__getattribute__"      </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; [11] "__getitem__"            "__gt__"                </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; [13] "__hash__"               "__init__"              </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; [15] "__init_subclass__"      "__le__"                </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; [17] "__len__"                "__lt__"                </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; [19] "__module__"             "__ne__"                </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; [21] "__new__"                "__reduce__"            </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; [23] "__reduce_ex__"          "__repr__"              </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; [25] "__setattr__"            "__sizeof__"            </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; [27] "__str__"                "__subclasshook__"      </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; [29] "__weakref__"            "_check_exists"         </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#&gt; [31] "_format_transform_repr" "_repr_indent"          </span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">#&gt; [33] "class_to_idx"           "classes"               </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">#&gt; [35] "data"                   "download"              </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; [37] "extra_repr"             "extract_gzip"          </span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; [39] "processed_folder"       "raw_folder"            </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; [41] "root"                   "target_transform"      </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; [43] "targets"                "test_data"             </span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; [45] "test_file"              "test_labels"           </span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; [47] "train"                  "train_data"            </span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; [49] "train_labels"           "training_file"         </span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; [51] "transform"              "transforms"            </span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; [53] "urls"</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># this is identical to Python len() function</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">train_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__len__</span><span class="st">`</span>()</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; [1] 60000</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># this is not what we are looking for which is torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">d0 &lt;-<span class="st"> </span>train_dataset<span class="op">$</span>data[<span class="dv">1</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt; Warning in `[.torch.Tensor`(train_dataset$data, 1, 1): Incorrect number of</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; dimensions supplied. The number of supplied arguments, (not counting any</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; NULL, tf$newaxis or np$newaxis) must match thenumber of dimensions in the</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; tensor, unless an all_dims() was supplied (this will produce an error in</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; the future)</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(d0)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; [1] "torch.Tensor"          "torch._C._TensorBase"  "python.builtin.object"</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">d0<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt; torch.Size([28])</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># this is identical to train_dataset.data.size() in Python</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">train_dataset<span class="op">$</span>data<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt; torch.Size([60000, 28, 28])</span></a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># this is not a dimension we are looking for either</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">train_dataset<span class="op">$</span>data[<span class="dv">2</span>, <span class="dv">1</span>]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Warning in `[.torch.Tensor`(train_dataset$data, 2, 1): Incorrect number of</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; dimensions supplied. The number of supplied arguments, (not counting any</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; NULL, tf$newaxis or np$newaxis) must match thenumber of dimensions in the</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; tensor, unless an all_dims() was supplied (this will produce an error in</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; the future)</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; torch.Size([28])</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># py = import_builtins()</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">enum_train_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(train_dataset)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(enum_train_dataset)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt; [1] "python.builtin.iterator"  "python.builtin.enumerate"</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; [3] "python.builtin.object"</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co"># enum_train_dataset$`__count__`</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_list_attributes">py_list_attributes</a></span>(enum_train_dataset)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt;  [1] "__class__"         "__delattr__"       "__dir__"          </span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt;  [4] "__doc__"           "__eq__"            "__format__"       </span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt;  [7] "__ge__"            "__getattribute__"  "__gt__"           </span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; [10] "__hash__"          "__init__"          "__init_subclass__"</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; [13] "__iter__"          "__le__"            "__lt__"           </span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; [16] "__ne__"            "__new__"           "__next__"         </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; [19] "__reduce__"        "__reduce_ex__"     "__repr__"         </span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; [22] "__setattr__"       "__sizeof__"        "__str__"          </span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; [25] "__subclasshook__"</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># this is not a number we were expecting</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">enum_train_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__sizeof__</span><span class="st">`</span>()</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; [1] 48</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">train_dataset<span class="op">$</span>data<span class="op">$</span><span class="kw">nelement</span>()  <span class="co"># total number of elements in the tensor</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt; [1] 47040000</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">train_dataset<span class="op">$</span>data<span class="op">$</span>shape       <span class="co"># shape</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; torch.Size([60000, 28, 28])</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">train_dataset<span class="op">$</span>data<span class="op">$</span><span class="kw">size</span>()      <span class="co"># size</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; torch.Size([60000, 28, 28])</span></a></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># get index, label and image</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co"># the pointer will move forward everytime we run the chunk</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">obj   &lt;-<span class="st"> </span>reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iter_next</a></span>(enum_train_dataset)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">idx   &lt;-<span class="st"> </span>obj[[<span class="dv">1</span>]]        <span class="co"># index number</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">image &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">label &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(idx, label, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(label), <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt; 0 5 integer  </span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(image<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a></code></pre></div>
</div>
<div id="introspection-training-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#introspection-training-dataset" class="anchor"></a>Introspection training dataset</h3>
<div id="inspecting-a-single-image" class="section level4">
<h4 class="hasAnchor">
<a href="#inspecting-a-single-image" class="anchor"></a>Inspecting a single image</h4>
<p>So this is how a single image is represented in numbers. Itâ€™s actually a 28 pixel x 28 pixel image which is why you would end up with this 28x28 matrix of numbers.</p>
</div>
<div id="inspecting-training-dataset-first-element-of-tuple" class="section level4">
<h4 class="hasAnchor">
<a href="#inspecting-training-dataset-first-element-of-tuple" class="anchor"></a>Inspecting training dataset first element of tuple</h4>
<p>This means to access the image, you need to access the first element in the tuple.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Input Matrix</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">image<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># A 28x28 sized image of a digit</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co"># torch.Size([1, 28, 28])</span></a></code></pre></div>
</div>
</div>
<div id="mnist-image-from-training-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#mnist-image-from-training-dataset" class="anchor"></a>MNIST image from training dataset</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(image<span class="op">$</span><span class="kw">numpy</span>())</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">#&gt; [1] "array"</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(image<span class="op">$</span><span class="kw">numpy</span>())</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt; [1]  1 28 28</span></a></code></pre></div>
<div id="plot-one-image" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-one-image" class="anchor"></a>Plot one image</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">rotate &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/t">t</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(x, <span class="dv">2</span>, rev))   <span class="co">#function to rotate the matrix</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co"># read label for digit</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">label</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co"># read tensor for image</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8">img_tensor_2d &lt;-<span class="st"> </span>image[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; Warning in `[.torch.Tensor`(image, 1): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14">img_tensor_2d<span class="op">$</span>shape       <span class="co"># shape of the 2D tensor: torch.Size([28, 28])</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; torch.Size([28, 28])</span></a>
<a class="sourceLine" id="cb18-16" data-line-number="16"></a>
<a class="sourceLine" id="cb18-17" data-line-number="17"><span class="co"># convert tensor to numpy array</span></a>
<a class="sourceLine" id="cb18-18" data-line-number="18">img_mat_2d &lt;-<span class="st"> </span>img_tensor_2d<span class="op">$</span><span class="kw">numpy</span>()</a>
<a class="sourceLine" id="cb18-19" data-line-number="19"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(img_mat_2d)</a>
<a class="sourceLine" id="cb18-20" data-line-number="20"><span class="co">#&gt; [1] 28 28</span></a>
<a class="sourceLine" id="cb18-21" data-line-number="21"></a>
<a class="sourceLine" id="cb18-22" data-line-number="22"><span class="co"># show digit image</span></a>
<a class="sourceLine" id="cb18-23" data-line-number="23"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/image">image</a></span>(<span class="kw">rotate</span>(img_mat_2d))</a>
<a class="sourceLine" id="cb18-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/title">title</a></span>(label)</a></code></pre></div>
<p><img src="idx_images_minist_digits_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
</div>
<div id="plot-a-second-image" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-a-second-image" class="anchor"></a>Plot a second image</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># iterate to the next tensor</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">obj &lt;-<span class="st"> </span>reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iter_next</a></span>(enum_train_dataset)   <span class="co"># iterator</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">idx &lt;-<span class="st"> </span>obj[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">img &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">lbl &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7">img_tensor_2d &lt;-<span class="st"> </span>img[<span class="dv">1</span>]            <span class="co"># get 2D tensor</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; Warning in `[.torch.Tensor`(img, 1): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">img_mat_2d &lt;-<span class="st"> </span>img_tensor_2d<span class="op">$</span><span class="kw">numpy</span>()  <span class="co"># convert to 2D array</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="co"># show digit image</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/image">image</a></span>(<span class="kw">rotate</span>(img_mat_2d))            <span class="co"># rotate and plot</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/title">title</a></span>(lbl)                         <span class="co"># label as plot title</span></a></code></pre></div>
<p><img src="idx_images_minist_digits_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div id="loading-the-test-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#loading-the-test-dataset" class="anchor"></a>Loading the test dataset</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">test_dataset =<span class="st"> </span>dsets<span class="op">$</span><span class="kw">MNIST</span>(<span class="dt">root =</span> local_folder, </a>
<a class="sourceLine" id="cb20-2" data-line-number="2">                           <span class="dt">train=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb20-3" data-line-number="3">                           <span class="dt">transform=</span>transforms<span class="op">$</span><span class="kw">ToTensor</span>())</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5">reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_len">py_len</a></span>(test_dataset)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt; [1] 10000</span></a></code></pre></div>
<div id="introspection-of-the-test-dataset" class="section level4">
<h4 class="hasAnchor">
<a href="#introspection-of-the-test-dataset" class="anchor"></a>Introspection of the test dataset</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># we'll get all the attributes of the class</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_list_attributes">py_list_attributes</a></span>(test_dataset)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co">#&gt;  [1] "__add__"                "__class__"             </span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="co">#&gt;  [3] "__delattr__"            "__dict__"              </span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co">#&gt;  [5] "__dir__"                "__doc__"               </span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="co">#&gt;  [7] "__eq__"                 "__format__"            </span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co">#&gt;  [9] "__ge__"                 "__getattribute__"      </span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8"><span class="co">#&gt; [11] "__getitem__"            "__gt__"                </span></a>
<a class="sourceLine" id="cb21-9" data-line-number="9"><span class="co">#&gt; [13] "__hash__"               "__init__"              </span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10"><span class="co">#&gt; [15] "__init_subclass__"      "__le__"                </span></a>
<a class="sourceLine" id="cb21-11" data-line-number="11"><span class="co">#&gt; [17] "__len__"                "__lt__"                </span></a>
<a class="sourceLine" id="cb21-12" data-line-number="12"><span class="co">#&gt; [19] "__module__"             "__ne__"                </span></a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co">#&gt; [21] "__new__"                "__reduce__"            </span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14"><span class="co">#&gt; [23] "__reduce_ex__"          "__repr__"              </span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15"><span class="co">#&gt; [25] "__setattr__"            "__sizeof__"            </span></a>
<a class="sourceLine" id="cb21-16" data-line-number="16"><span class="co">#&gt; [27] "__str__"                "__subclasshook__"      </span></a>
<a class="sourceLine" id="cb21-17" data-line-number="17"><span class="co">#&gt; [29] "__weakref__"            "_check_exists"         </span></a>
<a class="sourceLine" id="cb21-18" data-line-number="18"><span class="co">#&gt; [31] "_format_transform_repr" "_repr_indent"          </span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19"><span class="co">#&gt; [33] "class_to_idx"           "classes"               </span></a>
<a class="sourceLine" id="cb21-20" data-line-number="20"><span class="co">#&gt; [35] "data"                   "download"              </span></a>
<a class="sourceLine" id="cb21-21" data-line-number="21"><span class="co">#&gt; [37] "extra_repr"             "extract_gzip"          </span></a>
<a class="sourceLine" id="cb21-22" data-line-number="22"><span class="co">#&gt; [39] "processed_folder"       "raw_folder"            </span></a>
<a class="sourceLine" id="cb21-23" data-line-number="23"><span class="co">#&gt; [41] "root"                   "target_transform"      </span></a>
<a class="sourceLine" id="cb21-24" data-line-number="24"><span class="co">#&gt; [43] "targets"                "test_data"             </span></a>
<a class="sourceLine" id="cb21-25" data-line-number="25"><span class="co">#&gt; [45] "test_file"              "test_labels"           </span></a>
<a class="sourceLine" id="cb21-26" data-line-number="26"><span class="co">#&gt; [47] "train"                  "train_data"            </span></a>
<a class="sourceLine" id="cb21-27" data-line-number="27"><span class="co">#&gt; [49] "train_labels"           "training_file"         </span></a>
<a class="sourceLine" id="cb21-28" data-line-number="28"><span class="co">#&gt; [51] "transform"              "transforms"            </span></a>
<a class="sourceLine" id="cb21-29" data-line-number="29"><span class="co">#&gt; [53] "urls"</span></a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># get the Python type</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">builtins<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/typeof">type</a></span>(test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L))   <span class="co"># in Python a tuple gets converted to a list</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="co">#&gt; &lt;class 'list'&gt;</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="co"># in Python: type(test_dataset[0]) -&gt; &lt;class 'tuple'&gt;</span></a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># the size of the first and last image tensor</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()      <span class="co"># same as test_dataset[0][0].size()</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(9999L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()  </a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a></code></pre></div>
<p>This is the same as:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/r-py-conversion">py_to_r</a></span>(test_dataset)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt; Dataset MNIST</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">#&gt;     Number of datapoints: 10000</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">#&gt;     Root location: /home/msfz751/raw_data</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">#&gt;     Split: Test</span></a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># the size of the first and last image tensor</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co"># py_get_item(test_dataset, 0L)[[1]]$size()</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_get_item">py_get_item</a></span>(test_dataset, 0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_get_item">py_get_item</a></span>(test_dataset, 9999L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="co">#&gt; torch.Size([1, 28, 28])</span></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co"># same as test_dataset[0][0].size()</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># the label is the second list member</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">label &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">2</span>]]  <span class="co"># in Python: test_dataset[0][1]</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3">label</a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
</div>
</div>
<div id="plot-image-test-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-image-test-dataset" class="anchor"></a>Plot image test dataset</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># convert tensor to numpy array</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">.show_img &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>() </a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(.show_img)                                           <span class="co"># numpy 3D array</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">#&gt; [1]  1 28 28</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co"># reshape 3D array to 2D </span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7">show_img &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reshape">reshape</a></span>(.show_img, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(28L, 28L))</a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(show_img)</a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="co">#&gt; [1] 28 28</span></a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># another way to reshape the array</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">show_img &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reshape">reshape</a></span>(test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(0L)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>(), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(28L, 28L))</a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(show_img)</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">#&gt; [1] 28 28</span></a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># show in grays and rotate</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/image">image</a></span>(<span class="kw">rotate</span>(show_img), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/gray.colors">gray.colors</a></span>(<span class="dv">64</span>))</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/title">title</a></span>(label)</a></code></pre></div>
<p><img src="idx_images_minist_digits_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
<div id="plot-a-second-test-image" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-a-second-test-image" class="anchor"></a>Plot a second test image</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># next image, index moves from (0L) to (1L), and so on</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">idx &lt;-<span class="st"> </span>1L</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">.show_img &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>()</a>
<a class="sourceLine" id="cb30-4" data-line-number="4">show_img  &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reshape">reshape</a></span>(.show_img, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(28L, 28L))</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">label     &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb30-6" data-line-number="6"></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/image">image</a></span>(<span class="kw">rotate</span>(show_img), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/gray.colors">gray.colors</a></span>(<span class="dv">64</span>))</a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/title">title</a></span>(label)</a></code></pre></div>
<p><img src="idx_images_minist_digits_files/figure-html/unnamed-chunk-30-1.png" width="480"></p>
</div>
<div id="plot-the-last-test-image" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-the-last-test-image" class="anchor"></a>Plot the last test image</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># next image, index moves from (0L) to (1L), and so on</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="co"># first image is 0, last image would be 9999</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3">idx &lt;-<span class="st"> </span>reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_len">py_len</a></span>(test_dataset) <span class="op">-</span><span class="st"> </span>1L</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">.show_img &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">numpy</span>()</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">show_img  &lt;-<span class="st"> </span>np<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/reshape">reshape</a></span>(.show_img, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(28L, 28L))</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">label     &lt;-<span class="st"> </span>test_dataset<span class="op">$</span><span class="st">`</span><span class="dt">__getitem__</span><span class="st">`</span>(idx)[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb31-7" data-line-number="7"></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/image">image</a></span>(<span class="kw">rotate</span>(show_img), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/gray.colors">gray.colors</a></span>(<span class="dv">64</span>))</a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/title">title</a></span>(label)</a></code></pre></div>
<p><img src="idx_images_minist_digits_files/figure-html/unnamed-chunk-31-1.png" width="480"></p>
</div>
</div>
<div id="defining-epochs" class="section level2">
<h2 class="hasAnchor">
<a href="#defining-epochs" class="anchor"></a>Defining epochs</h2>
<p>When the model goes through the whole 60k images once, learning how to classify 0-9, itâ€™s consider <strong>1 epoch</strong>.</p>
<p>However, thereâ€™s a concept of batch size where it means the model would look at 100 images before updating the modelâ€™s weights, thereby learning. When the model updates its weights (parameters) after looking at all the images, this is considered 1 iteration.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">batch_size &lt;-<span class="st"> </span>100L</a></code></pre></div>
<p>We arbitrarily set 3000 iterations here which means the model would update 3000 times.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">n_iters &lt;-<span class="st"> </span>3000L</a></code></pre></div>
<p>One epoch consists of 60,000 / 100 = 600 iterations. Because we would like to go through 3000 iterations, this implies we would have 3000 / 600 = 5 epochs as each epoch has 600 iterations.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">num_epochs =<span class="st"> </span>n_iters <span class="op">/</span><span class="st"> </span>(reticulate<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_len">py_len</a></span>(train_dataset) <span class="op">/</span><span class="st"> </span>batch_size)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">num_epochs =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(num_epochs)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">num_epochs</a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co">#&gt; [1] 5</span></a></code></pre></div>
</div>
<div id="create-iterable-objects-training-and-testing-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#create-iterable-objects-training-and-testing-dataset" class="anchor"></a>Create iterable objects: training and testing dataset</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">train_loader =<span class="st"> </span>torch<span class="op">$</span>utils<span class="op">$</span>data<span class="op">$</span><span class="kw">DataLoader</span>(<span class="dt">dataset=</span>train_dataset, </a>
<a class="sourceLine" id="cb35-2" data-line-number="2">                                           <span class="dt">batch_size=</span>batch_size, </a>
<a class="sourceLine" id="cb35-3" data-line-number="3">                                           <span class="dt">shuffle=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># Iterable object</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2">test_loader =<span class="st"> </span>torch<span class="op">$</span>utils<span class="op">$</span>data<span class="op">$</span><span class="kw">DataLoader</span>(<span class="dt">dataset=</span>test_dataset, </a>
<a class="sourceLine" id="cb36-3" data-line-number="3">                                          <span class="dt">batch_size=</span>batch_size, </a>
<a class="sourceLine" id="cb36-4" data-line-number="4">                                          <span class="dt">shuffle=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div id="check-iteraibility" class="section level3">
<h3 class="hasAnchor">
<a href="#check-iteraibility" class="anchor"></a>Check iteraibility</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">collections &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/import">import</a></span>(<span class="st">"collections"</span>)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"></a>
<a class="sourceLine" id="cb37-3" data-line-number="3">builtins<span class="op">$</span><span class="kw">isinstance</span>(train_loader, collections<span class="op">$</span>Iterable)</a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5">builtins<span class="op">$</span><span class="kw">isinstance</span>(test_loader, collections<span class="op">$</span>Iterable)</a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
</div>
<div id="building-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#building-the-model" class="anchor"></a>Building the model</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># Same as linear regression! </span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">main &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/py_run">py_run_string</a></span>(</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="st">"</span></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="st">import torch.nn as nn</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="st">class LogisticRegressionModel(nn.Module):</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="st">    def __init__(self, input_dim, output_dim):</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="st">        super(LogisticRegressionModel, self).__init__()</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="st">        self.linear = nn.Linear(input_dim, output_dim)</span></a>
<a class="sourceLine" id="cb38-10" data-line-number="10"></a>
<a class="sourceLine" id="cb38-11" data-line-number="11"><span class="st">    def forward(self, x):</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12"><span class="st">        out = self.linear(x)</span></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="st">        return out</span></a>
<a class="sourceLine" id="cb38-14" data-line-number="14"><span class="st">"</span>)</a>
<a class="sourceLine" id="cb38-15" data-line-number="15"></a>
<a class="sourceLine" id="cb38-16" data-line-number="16"><span class="co"># build a Linear Rgression model</span></a>
<a class="sourceLine" id="cb38-17" data-line-number="17">LogisticRegressionModel &lt;-<span class="st"> </span>main<span class="op">$</span>LogisticRegressionModel</a></code></pre></div>
<div id="instantiate-model-class-based-on-input-and-out-dimensions" class="section level3">
<h3 class="hasAnchor">
<a href="#instantiate-model-class-based-on-input-and-out-dimensions" class="anchor"></a>Instantiate model class based on input and out dimensions</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># feeding the model with 28x28 images</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">input_dim =<span class="st"> </span>28L<span class="op">*</span>28L</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="co"># classify digits 0-9 a total of 10 classes,</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5">output_dim =<span class="st"> </span>10L</a>
<a class="sourceLine" id="cb39-6" data-line-number="6"></a>
<a class="sourceLine" id="cb39-7" data-line-number="7">model =<span class="st"> </span><span class="kw">LogisticRegressionModel</span>(input_dim, output_dim)</a></code></pre></div>
</div>
<div id="instantiate-cross-entropy-loss-class" class="section level3">
<h3 class="hasAnchor">
<a href="#instantiate-cross-entropy-loss-class" class="anchor"></a>Instantiate Cross Entropy Loss class</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># need Cross Entropy Loss to calculate loss before we backpropagation</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">criterion =<span class="st"> </span>nn<span class="op">$</span><span class="kw">CrossEntropyLoss</span>()  </a></code></pre></div>
</div>
<div id="instantiate-optimizer-class" class="section level3">
<h3 class="hasAnchor">
<a href="#instantiate-optimizer-class" class="anchor"></a>Instantiate Optimizer class</h3>
<p>Similar to what weâ€™ve covered above, this calculates the parametersâ€™ gradients and update them subsequently.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># calculate parameters' gradients and update</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">learning_rate =<span class="st"> </span><span class="fl">0.001</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"></a>
<a class="sourceLine" id="cb41-4" data-line-number="4">optimizer =<span class="st"> </span>torch<span class="op">$</span>optim<span class="op">$</span><span class="kw">SGD</span>(model<span class="op">$</span><span class="kw">parameters</span>(), <span class="dt">lr=</span>learning_rate)  </a></code></pre></div>
</div>
<div id="parameters-introspection" class="section level3">
<h3 class="hasAnchor">
<a href="#parameters-introspection" class="anchor"></a>Parameters introspection</h3>
<p>Youâ€™ll realize we have 2 sets of parameters, 10x784 which is <span class="math inline">\(A\)</span> and 10x1 which is <span class="math inline">\(b\)</span> in the <span class="math inline">\(y = AX + b\)</span> equation, where <span class="math inline">\(X\)</span> is our input of size 784.</p>
<p>Weâ€™ll go into details subsequently how these parameters interact with our input to produce our 10x1 output.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># Type of parameter object</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(model<span class="op">$</span><span class="kw">parameters</span>())</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="co">#&gt; &lt;generator object Module.parameters at 0x7f9477d655e8&gt;</span></a>
<a class="sourceLine" id="cb42-4" data-line-number="4">model_parameters &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(model<span class="op">$</span><span class="kw">parameters</span>())</a>
<a class="sourceLine" id="cb42-5" data-line-number="5"></a>
<a class="sourceLine" id="cb42-6" data-line-number="6"><span class="co"># Length of parameters</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(builtins<span class="op">$</span><span class="kw">len</span>(model_parameters))</a>
<a class="sourceLine" id="cb42-8" data-line-number="8"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb42-9" data-line-number="9"></a>
<a class="sourceLine" id="cb42-10" data-line-number="10"><span class="co"># FC 1 Parameters </span></a>
<a class="sourceLine" id="cb42-11" data-line-number="11">builtins<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(model_parameters)[[<span class="dv">1</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb42-12" data-line-number="12"><span class="co">#&gt; torch.Size([10, 784])</span></a>
<a class="sourceLine" id="cb42-13" data-line-number="13"></a>
<a class="sourceLine" id="cb42-14" data-line-number="14"><span class="co"># FC 1 Bias Parameters</span></a>
<a class="sourceLine" id="cb42-15" data-line-number="15">builtins<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(model_parameters)[[<span class="dv">2</span>]]<span class="op">$</span><span class="kw">size</span>()</a>
<a class="sourceLine" id="cb42-16" data-line-number="16"><span class="co">#&gt; torch.Size([10])</span></a></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1">builtins<span class="op">$</span><span class="kw">len</span>(builtins<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(model<span class="op">$</span><span class="kw">parameters</span>()))</a>
<a class="sourceLine" id="cb43-2" data-line-number="2"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
</div>
</div>
<div id="train-the-model-and-test-per-epoch" class="section level2">
<h2 class="hasAnchor">
<a href="#train-the-model-and-test-per-epoch" class="anchor"></a>Train the model and test per epoch</h2>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">iter =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="cf">for</span> (epoch <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_epochs) {</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">  iter_train_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(train_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb44-5" data-line-number="5">  <span class="cf">for</span> (obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_train_dataset)) {</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">      <span class="co"># get the tensors for images and labels</span></a>
<a class="sourceLine" id="cb44-7" data-line-number="7">      images &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb44-8" data-line-number="8">      labels &lt;-<span class="st"> </span>obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb44-9" data-line-number="9">      </a>
<a class="sourceLine" id="cb44-10" data-line-number="10">      <span class="co"># Reshape images to (batch_size, input_size)</span></a>
<a class="sourceLine" id="cb44-11" data-line-number="11">      images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb44-12" data-line-number="12">      </a>
<a class="sourceLine" id="cb44-13" data-line-number="13">      <span class="co"># Clear gradients w.r.t. parameters</span></a>
<a class="sourceLine" id="cb44-14" data-line-number="14">      optimizer<span class="op">$</span><span class="kw">zero_grad</span>()</a>
<a class="sourceLine" id="cb44-15" data-line-number="15">      </a>
<a class="sourceLine" id="cb44-16" data-line-number="16">      <span class="co"># Forward pass to get output/logits</span></a>
<a class="sourceLine" id="cb44-17" data-line-number="17">      outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb44-18" data-line-number="18">      </a>
<a class="sourceLine" id="cb44-19" data-line-number="19">      <span class="co"># Calculate Loss: softmax --&gt; cross entropy loss</span></a>
<a class="sourceLine" id="cb44-20" data-line-number="20">      loss =<span class="st"> </span><span class="kw">criterion</span>(outputs, labels)</a>
<a class="sourceLine" id="cb44-21" data-line-number="21">      </a>
<a class="sourceLine" id="cb44-22" data-line-number="22">      <span class="co"># Getting gradients w.r.t. parameters</span></a>
<a class="sourceLine" id="cb44-23" data-line-number="23">      loss<span class="op">$</span><span class="kw">backward</span>()</a>
<a class="sourceLine" id="cb44-24" data-line-number="24">      </a>
<a class="sourceLine" id="cb44-25" data-line-number="25">      <span class="co"># Updating parameters</span></a>
<a class="sourceLine" id="cb44-26" data-line-number="26">      optimizer<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/step">step</a></span>()</a>
<a class="sourceLine" id="cb44-27" data-line-number="27">      </a>
<a class="sourceLine" id="cb44-28" data-line-number="28">      iter =<span class="st"> </span>iter <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb44-29" data-line-number="29">      </a>
<a class="sourceLine" id="cb44-30" data-line-number="30">      <span class="cf">if</span> (iter <span class="op">%%</span><span class="st"> </span><span class="dv">500</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb44-31" data-line-number="31">          <span class="co"># Calculate Accuracy         </span></a>
<a class="sourceLine" id="cb44-32" data-line-number="32">          correct =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb44-33" data-line-number="33">          total =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb44-34" data-line-number="34">          </a>
<a class="sourceLine" id="cb44-35" data-line-number="35">          <span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb44-36" data-line-number="36">          iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb44-37" data-line-number="37">          <span class="cf">for</span> (obj2 <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb44-38" data-line-number="38">              <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb44-39" data-line-number="39">              images &lt;-<span class="st"> </span>obj2[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb44-40" data-line-number="40">              labels &lt;-<span class="st"> </span>obj2[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb44-41" data-line-number="41">              images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb44-42" data-line-number="42">          </a>
<a class="sourceLine" id="cb44-43" data-line-number="43">              <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb44-44" data-line-number="44">              outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb44-45" data-line-number="45">          </a>
<a class="sourceLine" id="cb44-46" data-line-number="46">              <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb44-47" data-line-number="47">              .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb44-48" data-line-number="48">              predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb44-49" data-line-number="49">          </a>
<a class="sourceLine" id="cb44-50" data-line-number="50">              <span class="co"># Total number of labels</span></a>
<a class="sourceLine" id="cb44-51" data-line-number="51">              total =<span class="st"> </span>total <span class="op">+</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">size</span>(0L)</a>
<a class="sourceLine" id="cb44-52" data-line-number="52">          </a>
<a class="sourceLine" id="cb44-53" data-line-number="53">              <span class="co"># Total correct predictions</span></a>
<a class="sourceLine" id="cb44-54" data-line-number="54">              correct =<span class="st"> </span>correct <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>((predicted<span class="op">$</span><span class="kw">numpy</span>() <span class="op">==</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">numpy</span>()))</a>
<a class="sourceLine" id="cb44-55" data-line-number="55">          }</a>
<a class="sourceLine" id="cb44-56" data-line-number="56">          accuracy =<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>correct <span class="op">/</span><span class="st"> </span>total</a>
<a class="sourceLine" id="cb44-57" data-line-number="57">          </a>
<a class="sourceLine" id="cb44-58" data-line-number="58">          <span class="co"># Print Loss</span></a>
<a class="sourceLine" id="cb44-59" data-line-number="59">          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sprintf">sprintf</a></span>(<span class="st">'Iteration: %5d. Loss: %f. Accuracy: %8.2f </span><span class="ch">\n</span><span class="st">'</span>, </a>
<a class="sourceLine" id="cb44-60" data-line-number="60">                      iter, loss<span class="op">$</span><span class="kw">item</span>(), accuracy))</a>
<a class="sourceLine" id="cb44-61" data-line-number="61">      }</a>
<a class="sourceLine" id="cb44-62" data-line-number="62">  }</a>
<a class="sourceLine" id="cb44-63" data-line-number="63">}  </a>
<a class="sourceLine" id="cb44-64" data-line-number="64"><span class="co">#&gt; Iteration:   500. Loss: 1.840515. Accuracy:    68.56 </span></a>
<a class="sourceLine" id="cb44-65" data-line-number="65"><span class="co">#&gt; Iteration:  1000. Loss: 1.538463. Accuracy:    76.27 </span></a>
<a class="sourceLine" id="cb44-66" data-line-number="66"><span class="co">#&gt; Iteration:  1500. Loss: 1.337989. Accuracy:    79.57 </span></a>
<a class="sourceLine" id="cb44-67" data-line-number="67"><span class="co">#&gt; Iteration:  2000. Loss: 1.143398. Accuracy:    81.04 </span></a>
<a class="sourceLine" id="cb44-68" data-line-number="68"><span class="co">#&gt; Iteration:  2500. Loss: 1.091558. Accuracy:    82.05 </span></a>
<a class="sourceLine" id="cb44-69" data-line-number="69"><span class="co">#&gt; Iteration:  3000. Loss: 1.027075. Accuracy:    82.75</span></a></code></pre></div>
</div>
<div id="break-down-accuracy-calculation" class="section level2">
<h2 class="hasAnchor">
<a href="#break-down-accuracy-calculation" class="anchor"></a>Break down accuracy calculation</h2>
<p>As weâ€™ve trained our model, we can extract the accuracy calculation portion to understand whatâ€™s happening without re-training the model.</p>
<p>This would print out the output of the modelâ€™s predictions on your notebook.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb45-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb45-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb45-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb45-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb45-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb45-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb45-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb45-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb45-14" data-line-number="14">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb45-15" data-line-number="15">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'OUTPUTS'</span>)</a>
<a class="sourceLine" id="cb45-16" data-line-number="16">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(outputs)</a>
<a class="sourceLine" id="cb45-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb45-18" data-line-number="18">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb45-19" data-line-number="19">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb45-20" data-line-number="20">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb45-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb45-22" data-line-number="22"><span class="co">#&gt; [1] "OUTPUTS"</span></a>
<a class="sourceLine" id="cb45-23" data-line-number="23"><span class="co">#&gt; tensor([[-3.4564e-01, -1.1338e+00, -6.0006e-01, -2.5275e-02, -1.4853e-02,</span></a>
<a class="sourceLine" id="cb45-24" data-line-number="24"><span class="co">#&gt;          -3.3151e-01, -1.1867e+00,  2.8442e+00, -1.0472e-01,  8.8659e-01],</span></a>
<a class="sourceLine" id="cb45-25" data-line-number="25"><span class="co">#&gt;         [ 3.5293e-01, -4.5890e-02,  1.4756e+00,  9.8685e-01, -1.9499e+00,</span></a>
<a class="sourceLine" id="cb45-26" data-line-number="26"><span class="co">#&gt;           6.2585e-01,  1.2490e+00, -2.1181e+00,  4.4414e-01, -1.6655e+00],</span></a>
<a class="sourceLine" id="cb45-27" data-line-number="27"><span class="co">#&gt;         [-8.4013e-01,  2.3500e+00,  1.9918e-01,  8.8181e-02, -4.4141e-01,</span></a>
<a class="sourceLine" id="cb45-28" data-line-number="28"><span class="co">#&gt;          -3.0882e-01, -1.5853e-01, -2.0936e-01,  1.4088e-01, -4.8771e-01],</span></a>
<a class="sourceLine" id="cb45-29" data-line-number="29"><span class="co">#&gt;         [ 2.7975e+00, -2.5580e+00, -1.5869e-01, -2.1608e-01, -9.6239e-01,</span></a>
<a class="sourceLine" id="cb45-30" data-line-number="30"><span class="co">#&gt;           7.7862e-01,  1.2519e+00,  1.8450e-01, -5.2105e-01, -1.7821e-01],</span></a>
<a class="sourceLine" id="cb45-31" data-line-number="31"><span class="co">#&gt;         [-1.4184e-01, -2.0367e+00,  4.0580e-01, -5.0936e-01,  1.6271e+00,</span></a>
<a class="sourceLine" id="cb45-32" data-line-number="32"><span class="co">#&gt;          -4.7728e-01,  1.6816e-03,  2.3693e-01,  3.3733e-02,  8.1843e-01],</span></a>
<a class="sourceLine" id="cb45-33" data-line-number="33"><span class="co">#&gt;         [-1.3058e+00,  2.8085e+00,  9.4739e-02,  1.4033e-01, -4.6524e-01,</span></a>
<a class="sourceLine" id="cb45-34" data-line-number="34"><span class="co">#&gt;          -3.7854e-01, -6.8885e-01, -9.9558e-02,  3.5212e-01, -3.9642e-01],</span></a>
<a class="sourceLine" id="cb45-35" data-line-number="35"><span class="co">#&gt;         [-1.1631e+00, -1.3389e+00, -8.6857e-01,  1.6165e-01,  1.2900e+00,</span></a>
<a class="sourceLine" id="cb45-36" data-line-number="36"><span class="co">#&gt;           4.5810e-02, -7.9668e-01,  4.7238e-01,  4.3097e-01,  8.3733e-01],</span></a>
<a class="sourceLine" id="cb45-37" data-line-number="37"><span class="co">#&gt;         [-1.3460e+00, -3.2760e-01, -5.2732e-01, -3.5533e-02,  7.8892e-01,</span></a>
<a class="sourceLine" id="cb45-38" data-line-number="38"><span class="co">#&gt;           2.8155e-01,  1.7967e-01,  2.7626e-02, -8.9529e-02,  1.2822e+00],</span></a>
<a class="sourceLine" id="cb45-39" data-line-number="39"><span class="co">#&gt;         [ 4.1083e-01, -3.7315e-01,  7.4299e-01, -1.2699e+00,  6.3834e-01,</span></a>
<a class="sourceLine" id="cb45-40" data-line-number="40"><span class="co">#&gt;           1.5430e-01,  7.2954e-01, -1.0911e+00,  1.3444e-01, -1.8111e-01],</span></a>
<a class="sourceLine" id="cb45-41" data-line-number="41"><span class="co">#&gt;         [-6.2765e-01, -7.6508e-01, -1.0431e+00, -1.2190e+00,  1.2631e+00,</span></a>
<a class="sourceLine" id="cb45-42" data-line-number="42"><span class="co">#&gt;          -1.7704e-01, -5.3163e-01,  1.7202e+00,  3.3362e-02,  1.8139e+00],</span></a>
<a class="sourceLine" id="cb45-43" data-line-number="43"><span class="co">#&gt;         [ 3.3998e+00, -1.9856e+00,  3.4907e-01,  9.7559e-01, -8.3843e-01,</span></a>
<a class="sourceLine" id="cb45-44" data-line-number="44"><span class="co">#&gt;           8.9590e-01, -6.0659e-01, -1.6241e+00,  5.5209e-01, -1.8356e+00],</span></a>
<a class="sourceLine" id="cb45-45" data-line-number="45"><span class="co">#&gt;         [ 7.5068e-01, -6.2523e-01,  3.2750e-01, -9.7976e-02,  6.6215e-02,</span></a>
<a class="sourceLine" id="cb45-46" data-line-number="46"><span class="co">#&gt;          -4.8735e-01,  6.1056e-01, -1.2832e+00,  2.4298e-01, -5.8321e-01],</span></a>
<a class="sourceLine" id="cb45-47" data-line-number="47"><span class="co">#&gt;         [-8.3449e-01, -1.4498e+00, -8.3416e-01, -9.8658e-01,  1.4281e+00,</span></a>
<a class="sourceLine" id="cb45-48" data-line-number="48"><span class="co">#&gt;          -5.7043e-02, -2.0422e-01,  9.8864e-01,  2.1449e-01,  2.2930e+00],</span></a>
<a class="sourceLine" id="cb45-49" data-line-number="49"><span class="co">#&gt;         [ 2.9179e+00, -2.3663e+00, -2.6902e-01, -4.0659e-01, -4.0510e-01,</span></a>
<a class="sourceLine" id="cb45-50" data-line-number="50"><span class="co">#&gt;           9.0175e-01, -3.8771e-01, -6.9812e-01,  5.5749e-01,  3.1349e-01],</span></a>
<a class="sourceLine" id="cb45-51" data-line-number="51"><span class="co">#&gt;         [-1.2484e+00,  2.5977e+00, -1.2415e-01,  5.4644e-01, -9.5376e-01,</span></a>
<a class="sourceLine" id="cb45-52" data-line-number="52"><span class="co">#&gt;          -1.7998e-01, -2.3899e-02, -3.0995e-01,  2.9802e-01, -3.5692e-01],</span></a>
<a class="sourceLine" id="cb45-53" data-line-number="53"><span class="co">#&gt;         [ 3.7665e-01, -7.6371e-01, -1.4747e-01,  1.5318e+00, -5.2400e-01,</span></a>
<a class="sourceLine" id="cb45-54" data-line-number="54"><span class="co">#&gt;           6.3339e-01, -3.8516e-01, -5.0900e-01,  3.9709e-01, -5.4781e-01],</span></a>
<a class="sourceLine" id="cb45-55" data-line-number="55"><span class="co">#&gt;         [-4.8063e-01, -1.9716e+00, -3.6043e-02, -5.6480e-01,  1.2700e+00,</span></a>
<a class="sourceLine" id="cb45-56" data-line-number="56"><span class="co">#&gt;          -6.4104e-01, -2.9336e-01,  7.7066e-01,  1.5368e-01,  1.8586e+00],</span></a>
<a class="sourceLine" id="cb45-57" data-line-number="57"><span class="co">#&gt;         [ 3.4425e-02, -1.5360e+00, -8.1319e-01,  5.5049e-01, -3.1270e-01,</span></a>
<a class="sourceLine" id="cb45-58" data-line-number="58"><span class="co">#&gt;          -3.1395e-01, -8.4846e-01,  2.5693e+00, -3.8503e-01,  5.3861e-01],</span></a>
<a class="sourceLine" id="cb45-59" data-line-number="59"><span class="co">#&gt;         [-8.7019e-01, -2.1584e-01, -8.1031e-02,  9.6291e-01, -6.8066e-01,</span></a>
<a class="sourceLine" id="cb45-60" data-line-number="60"><span class="co">#&gt;           1.4504e-01,  7.7224e-01, -4.9435e-01,  1.8610e-01, -1.9395e-01],</span></a>
<a class="sourceLine" id="cb45-61" data-line-number="61"><span class="co">#&gt;         [-1.0397e+00, -1.4268e+00, -5.3041e-01, -2.1455e-01,  1.8663e+00,</span></a>
<a class="sourceLine" id="cb45-62" data-line-number="62"><span class="co">#&gt;          -2.3999e-03, -1.5312e-01,  6.0587e-02, -1.3017e-01,  1.2754e+00],</span></a>
<a class="sourceLine" id="cb45-63" data-line-number="63"><span class="co">#&gt;         [-9.7659e-01, -3.3179e-01, -1.2522e+00,  4.0296e-02,  5.3771e-01,</span></a>
<a class="sourceLine" id="cb45-64" data-line-number="64"><span class="co">#&gt;           2.7951e-01, -1.3215e+00,  1.6229e+00,  2.5743e-01,  1.5247e+00],</span></a>
<a class="sourceLine" id="cb45-65" data-line-number="65"><span class="co">#&gt;         [-7.4157e-01, -1.6358e+00, -1.2797e-01, -9.6821e-03,  3.0762e-01,</span></a>
<a class="sourceLine" id="cb45-66" data-line-number="66"><span class="co">#&gt;           3.0982e-01,  1.9919e+00, -1.4911e+00,  2.2351e-01, -1.8131e-01],</span></a>
<a class="sourceLine" id="cb45-67" data-line-number="67"><span class="co">#&gt;         [-5.5107e-01,  9.2378e-02,  3.8456e-01, -8.4591e-01,  9.2701e-01,</span></a>
<a class="sourceLine" id="cb45-68" data-line-number="68"><span class="co">#&gt;          -1.3538e+00,  9.9248e-01, -1.5643e-01,  3.3792e-02, -5.3331e-02],</span></a>
<a class="sourceLine" id="cb45-69" data-line-number="69"><span class="co">#&gt;         [-1.5353e-02, -9.0952e-01, -5.8750e-01,  2.1999e-01, -3.0358e-02,</span></a>
<a class="sourceLine" id="cb45-70" data-line-number="70"><span class="co">#&gt;           1.2112e+00,  5.3638e-01, -7.0473e-01,  8.2842e-01, -9.2016e-02],</span></a>
<a class="sourceLine" id="cb45-71" data-line-number="71"><span class="co">#&gt;         [-7.9446e-01, -1.1870e+00, -4.6613e-02,  2.7338e-02,  1.3841e+00,</span></a>
<a class="sourceLine" id="cb45-72" data-line-number="72"><span class="co">#&gt;          -2.1337e-01, -2.2437e-01,  2.7189e-01, -1.8418e-01,  9.6575e-01],</span></a>
<a class="sourceLine" id="cb45-73" data-line-number="73"><span class="co">#&gt;         [ 4.3527e+00, -2.9079e+00,  5.5776e-01, -1.3545e+00, -3.0697e-01,</span></a>
<a class="sourceLine" id="cb45-74" data-line-number="74"><span class="co">#&gt;           9.4055e-01,  8.2782e-01, -1.0096e+00, -1.6788e-01, -1.4654e+00],</span></a>
<a class="sourceLine" id="cb45-75" data-line-number="75"><span class="co">#&gt;         [-2.9389e-01, -1.2314e+00, -5.1718e-01,  9.1438e-02,  3.6233e-01,</span></a>
<a class="sourceLine" id="cb45-76" data-line-number="76"><span class="co">#&gt;          -2.5849e-01, -7.0578e-01,  1.8693e+00, -3.6611e-01,  1.1335e+00],</span></a>
<a class="sourceLine" id="cb45-77" data-line-number="77"><span class="co">#&gt;         [-5.2664e-01, -2.2328e+00, -3.5500e-01, -8.1280e-01,  2.1703e+00,</span></a>
<a class="sourceLine" id="cb45-78" data-line-number="78"><span class="co">#&gt;          -1.3318e-01,  1.6017e-01, -1.6041e-01, -2.5300e-02,  1.3998e+00],</span></a>
<a class="sourceLine" id="cb45-79" data-line-number="79"><span class="co">#&gt;         [ 2.6414e+00, -2.3608e+00,  1.7482e-01,  8.9205e-01, -1.1931e+00,</span></a>
<a class="sourceLine" id="cb45-80" data-line-number="80"><span class="co">#&gt;           8.4127e-01, -2.3751e-01, -8.4435e-01,  6.2538e-01, -7.0155e-01],</span></a>
<a class="sourceLine" id="cb45-81" data-line-number="81"><span class="co">#&gt;         [-1.0687e+00,  1.3316e+00, -3.3817e-01,  1.4141e-01, -4.6058e-01,</span></a>
<a class="sourceLine" id="cb45-82" data-line-number="82"><span class="co">#&gt;           1.7700e-01,  3.3515e-02, -2.9162e-01,  4.3766e-01, -3.5233e-01],</span></a>
<a class="sourceLine" id="cb45-83" data-line-number="83"><span class="co">#&gt;         [-8.8157e-01, -1.3030e-01, -1.0126e+00,  2.3277e+00, -1.1148e+00,</span></a>
<a class="sourceLine" id="cb45-84" data-line-number="84"><span class="co">#&gt;           9.5477e-01, -2.8673e-01,  4.9695e-01,  1.7349e-01, -3.6863e-02],</span></a>
<a class="sourceLine" id="cb45-85" data-line-number="85"><span class="co">#&gt;         [-9.6790e-01,  1.1640e+00, -4.2848e-01,  3.2053e-01, -2.2841e-01,</span></a>
<a class="sourceLine" id="cb45-86" data-line-number="86"><span class="co">#&gt;           1.9960e-02, -2.3662e-01,  4.4998e-03,  1.3628e-01,  1.6750e-01],</span></a>
<a class="sourceLine" id="cb45-87" data-line-number="87"><span class="co">#&gt;         [-9.7734e-01, -7.1927e-01, -7.5814e-01,  2.2876e+00, -3.3723e-01,</span></a>
<a class="sourceLine" id="cb45-88" data-line-number="88"><span class="co">#&gt;           1.4483e+00, -2.5768e-01, -1.2393e+00,  3.4632e-01, -9.3916e-02],</span></a>
<a class="sourceLine" id="cb45-89" data-line-number="89"><span class="co">#&gt;         [ 1.5425e+00, -1.6096e+00,  7.6501e-01, -2.0622e+00,  7.4708e-01,</span></a>
<a class="sourceLine" id="cb45-90" data-line-number="90"><span class="co">#&gt;           4.3546e-02,  1.3679e+00, -8.6783e-01, -1.8846e-01, -1.8515e-01],</span></a>
<a class="sourceLine" id="cb45-91" data-line-number="91"><span class="co">#&gt;         [-8.7473e-01, -3.0094e-01,  8.8948e-01, -3.7530e-01, -2.1085e-01,</span></a>
<a class="sourceLine" id="cb45-92" data-line-number="92"><span class="co">#&gt;          -3.9884e-01, -1.3686e+00,  1.6825e+00,  6.5789e-01,  5.9253e-01],</span></a>
<a class="sourceLine" id="cb45-93" data-line-number="93"><span class="co">#&gt;         [ 3.9754e-01, -1.3424e+00,  2.5359e+00,  3.4030e-01, -1.1126e+00,</span></a>
<a class="sourceLine" id="cb45-94" data-line-number="94"><span class="co">#&gt;           8.6124e-02,  4.3843e-01, -6.6871e-01,  3.4705e-01, -1.7173e+00],</span></a>
<a class="sourceLine" id="cb45-95" data-line-number="95"><span class="co">#&gt;         [-4.6276e-01, -1.6667e+00,  1.0630e-01, -1.1182e-01, -3.2904e-01,</span></a>
<a class="sourceLine" id="cb45-96" data-line-number="96"><span class="co">#&gt;          -4.6474e-01, -4.7117e-01,  2.1182e+00, -2.6756e-01,  1.1419e+00],</span></a>
<a class="sourceLine" id="cb45-97" data-line-number="97"><span class="co">#&gt;         [-1.2504e+00,  2.0327e+00, -4.5093e-01,  6.6280e-02, -4.9623e-01,</span></a>
<a class="sourceLine" id="cb45-98" data-line-number="98"><span class="co">#&gt;          -4.3873e-02, -8.2564e-02, -1.0702e-01,  4.5615e-01, -6.4129e-02],</span></a>
<a class="sourceLine" id="cb45-99" data-line-number="99"><span class="co">#&gt;         [ 3.4009e-01,  5.0829e-01,  8.9266e-01,  1.3126e+00, -1.9481e+00,</span></a>
<a class="sourceLine" id="cb45-100" data-line-number="100"><span class="co">#&gt;           3.3435e-01,  5.4201e-01, -1.2257e+00,  5.9783e-01, -1.4746e+00],</span></a>
<a class="sourceLine" id="cb45-101" data-line-number="101"><span class="co">#&gt;         [-1.3904e+00,  2.8958e+00, -2.5935e-01,  4.1800e-01, -1.1940e+00,</span></a>
<a class="sourceLine" id="cb45-102" data-line-number="102"><span class="co">#&gt;           5.7660e-02, -1.4340e-02, -7.2440e-01,  5.8147e-01, -4.1214e-01],</span></a>
<a class="sourceLine" id="cb45-103" data-line-number="103"><span class="co">#&gt;         [-6.7267e-01,  1.5388e+00, -2.0450e-02,  1.3740e-01, -3.3902e-01,</span></a>
<a class="sourceLine" id="cb45-104" data-line-number="104"><span class="co">#&gt;          -1.1146e-01, -5.5716e-02, -1.5294e-01,  6.1530e-02, -2.3775e-01],</span></a>
<a class="sourceLine" id="cb45-105" data-line-number="105"><span class="co">#&gt;         [-8.8435e-01, -8.6494e-01, -2.2825e-01, -2.3642e-01,  3.6957e-02,</span></a>
<a class="sourceLine" id="cb45-106" data-line-number="106"><span class="co">#&gt;          -2.0776e-01, -7.3426e-01,  2.1282e+00, -2.3453e-01,  1.2844e+00],</span></a>
<a class="sourceLine" id="cb45-107" data-line-number="107"><span class="co">#&gt;         [-1.9952e+00, -5.0457e-01, -4.0010e-01, -3.5279e-01,  2.0788e+00,</span></a>
<a class="sourceLine" id="cb45-108" data-line-number="108"><span class="co">#&gt;          -6.8136e-01, -1.0446e+00,  4.3757e-01,  4.2377e-01,  1.6438e+00],</span></a>
<a class="sourceLine" id="cb45-109" data-line-number="109"><span class="co">#&gt;         [-3.3724e-01,  8.2052e-01,  1.0790e+00, -1.6590e-01, -2.7806e-01,</span></a>
<a class="sourceLine" id="cb45-110" data-line-number="110"><span class="co">#&gt;          -3.4032e-01, -6.1010e-02, -1.3644e+00,  4.5521e-01, -4.0807e-01],</span></a>
<a class="sourceLine" id="cb45-111" data-line-number="111"><span class="co">#&gt;         [-1.0767e+00,  1.3945e-01, -1.0659e-01,  1.3694e+00, -6.4423e-01,</span></a>
<a class="sourceLine" id="cb45-112" data-line-number="112"><span class="co">#&gt;           5.1645e-01,  5.1543e-01, -2.4258e-01,  1.1903e-01, -2.2836e-01],</span></a>
<a class="sourceLine" id="cb45-113" data-line-number="113"><span class="co">#&gt;         [ 1.7767e-01, -1.1577e+00, -5.2339e-01,  1.5442e+00, -6.0870e-01,</span></a>
<a class="sourceLine" id="cb45-114" data-line-number="114"><span class="co">#&gt;           1.1883e+00, -8.5313e-02, -1.3257e+00,  9.5786e-01, -6.5569e-01],</span></a>
<a class="sourceLine" id="cb45-115" data-line-number="115"><span class="co">#&gt;         [-1.4993e+00,  2.7249e-01,  1.4760e-01,  6.9671e-01, -1.8482e-01,</span></a>
<a class="sourceLine" id="cb45-116" data-line-number="116"><span class="co">#&gt;           3.5277e-01, -5.5182e-02, -8.3887e-02,  3.8110e-01,  1.9376e-01],</span></a>
<a class="sourceLine" id="cb45-117" data-line-number="117"><span class="co">#&gt;         [-7.0144e-01, -3.3324e-01,  1.6060e+00, -4.6872e-01,  2.1697e-01,</span></a>
<a class="sourceLine" id="cb45-118" data-line-number="118"><span class="co">#&gt;          -7.7753e-01,  6.2622e-01, -4.4679e-01,  3.4942e-02,  1.7759e-02],</span></a>
<a class="sourceLine" id="cb45-119" data-line-number="119"><span class="co">#&gt;         [-1.0980e+00, -2.7875e+00, -1.4590e+00, -2.8433e-01,  2.6349e+00,</span></a>
<a class="sourceLine" id="cb45-120" data-line-number="120"><span class="co">#&gt;           2.0795e-01, -8.8892e-01,  2.5040e-01,  6.7171e-01,  1.9528e+00],</span></a>
<a class="sourceLine" id="cb45-121" data-line-number="121"><span class="co">#&gt;         [-4.8091e-01, -2.2372e+00,  6.7722e-01, -5.3544e-01,  2.2275e+00,</span></a>
<a class="sourceLine" id="cb45-122" data-line-number="122"><span class="co">#&gt;          -8.6331e-01,  2.3889e-01,  8.9700e-02, -3.7699e-01,  1.0318e+00],</span></a>
<a class="sourceLine" id="cb45-123" data-line-number="123"><span class="co">#&gt;         [-8.8515e-02, -8.9275e-01,  1.2656e-01,  2.9868e-01, -3.5599e-01,</span></a>
<a class="sourceLine" id="cb45-124" data-line-number="124"><span class="co">#&gt;           4.8885e-01,  2.1363e+00, -1.2017e+00, -1.1939e-01, -5.0921e-01],</span></a>
<a class="sourceLine" id="cb45-125" data-line-number="125"><span class="co">#&gt;         [-3.1854e-01, -9.4168e-01, -4.0079e-01,  1.9384e+00, -8.3478e-01,</span></a>
<a class="sourceLine" id="cb45-126" data-line-number="126"><span class="co">#&gt;           3.6064e-01, -4.6157e-02, -3.0805e-01, -3.0790e-01, -6.3160e-02],</span></a>
<a class="sourceLine" id="cb45-127" data-line-number="127"><span class="co">#&gt;         [ 5.4823e-01, -1.0671e+00, -1.3290e+00, -1.4840e-01,  8.3261e-01,</span></a>
<a class="sourceLine" id="cb45-128" data-line-number="128"><span class="co">#&gt;           1.2996e+00,  5.2546e-02, -1.5022e-01,  1.6213e-01,  3.7446e-01],</span></a>
<a class="sourceLine" id="cb45-129" data-line-number="129"><span class="co">#&gt;         [ 3.0154e-01, -7.0436e-01, -3.2758e-01,  1.1673e+00, -8.4220e-02,</span></a>
<a class="sourceLine" id="cb45-130" data-line-number="130"><span class="co">#&gt;           6.8284e-01, -2.1290e-01, -7.4883e-01,  2.5903e-01, -4.2275e-01],</span></a>
<a class="sourceLine" id="cb45-131" data-line-number="131"><span class="co">#&gt;         [ 2.3479e-01, -3.1610e-01,  1.4768e+00, -2.3131e-01,  4.7199e-01,</span></a>
<a class="sourceLine" id="cb45-132" data-line-number="132"><span class="co">#&gt;          -1.0366e+00,  9.2816e-01, -7.4728e-01,  1.9848e-01, -5.8543e-01],</span></a>
<a class="sourceLine" id="cb45-133" data-line-number="133"><span class="co">#&gt;         [ 1.3947e+00, -2.1881e+00, -5.5260e-01,  1.8833e-01, -6.7838e-01,</span></a>
<a class="sourceLine" id="cb45-134" data-line-number="134"><span class="co">#&gt;           9.4674e-01,  1.7412e-01, -9.4523e-01,  1.2730e+00, -1.9944e-01],</span></a>
<a class="sourceLine" id="cb45-135" data-line-number="135"><span class="co">#&gt;         [ 5.2484e-02, -2.8911e+00, -8.9029e-02, -4.8200e-01,  2.5001e+00,</span></a>
<a class="sourceLine" id="cb45-136" data-line-number="136"><span class="co">#&gt;          -1.6784e-01,  3.6697e-01, -3.5334e-01, -3.3022e-02,  8.2528e-01],</span></a>
<a class="sourceLine" id="cb45-137" data-line-number="137"><span class="co">#&gt;         [-8.4753e-01,  2.4456e+00,  1.1589e-01,  2.2028e-01, -7.1533e-01,</span></a>
<a class="sourceLine" id="cb45-138" data-line-number="138"><span class="co">#&gt;          -1.5086e-01, -5.3197e-01, -1.0506e-01,  2.8914e-01, -3.0901e-01],</span></a>
<a class="sourceLine" id="cb45-139" data-line-number="139"><span class="co">#&gt;         [-3.7863e-01, -1.8275e+00, -9.8749e-01, -8.3060e-01,  1.7678e+00,</span></a>
<a class="sourceLine" id="cb45-140" data-line-number="140"><span class="co">#&gt;          -3.6149e-01, -1.3610e-01,  9.9308e-01, -3.4906e-01,  2.1908e+00],</span></a>
<a class="sourceLine" id="cb45-141" data-line-number="141"><span class="co">#&gt;         [ 1.6377e-02,  1.7556e-01, -4.1718e-01, -3.2914e-01,  2.7074e-01,</span></a>
<a class="sourceLine" id="cb45-142" data-line-number="142"><span class="co">#&gt;           4.9505e-01, -2.1903e-01,  4.0314e-01,  1.7224e-01, -3.5015e-01],</span></a>
<a class="sourceLine" id="cb45-143" data-line-number="143"><span class="co">#&gt;         [-3.8433e-01, -1.8910e+00, -8.7773e-01,  6.2353e-01,  2.2266e-01,</span></a>
<a class="sourceLine" id="cb45-144" data-line-number="144"><span class="co">#&gt;          -3.1590e-01, -6.0868e-01,  2.2409e+00, -6.2684e-01,  2.4644e-01],</span></a>
<a class="sourceLine" id="cb45-145" data-line-number="145"><span class="co">#&gt;         [ 2.6305e-01, -9.7892e-01,  1.2133e+00, -1.5093e+00, -4.3023e-01,</span></a>
<a class="sourceLine" id="cb45-146" data-line-number="146"><span class="co">#&gt;           1.8726e-02,  4.9466e-01, -7.4150e-01,  1.1868e+00,  2.6013e-01],</span></a>
<a class="sourceLine" id="cb45-147" data-line-number="147"><span class="co">#&gt;         [-9.0674e-01, -9.4848e-01, -1.5987e-01, -3.8920e-01,  6.1216e-01,</span></a>
<a class="sourceLine" id="cb45-148" data-line-number="148"><span class="co">#&gt;           4.8064e-02, -8.9842e-03, -2.7495e-01,  3.2685e-01,  1.1225e+00],</span></a>
<a class="sourceLine" id="cb45-149" data-line-number="149"><span class="co">#&gt;         [-9.6983e-01, -2.5722e-01,  1.1940e+00,  6.5705e-01, -2.5144e-01,</span></a>
<a class="sourceLine" id="cb45-150" data-line-number="150"><span class="co">#&gt;          -1.4530e-01, -3.7849e-01, -9.2955e-01,  3.4447e-01,  2.9862e-01],</span></a>
<a class="sourceLine" id="cb45-151" data-line-number="151"><span class="co">#&gt;         [-9.4627e-01, -9.6231e-01,  2.9115e-01, -4.8892e-01,  7.6869e-01,</span></a>
<a class="sourceLine" id="cb45-152" data-line-number="152"><span class="co">#&gt;          -6.0418e-01, -5.3591e-01,  1.5442e+00,  1.4812e-01,  6.2634e-01],</span></a>
<a class="sourceLine" id="cb45-153" data-line-number="153"><span class="co">#&gt;         [-1.3399e+00, -4.9677e-01, -6.6660e-01,  3.2265e-01,  5.1796e-01,</span></a>
<a class="sourceLine" id="cb45-154" data-line-number="154"><span class="co">#&gt;           2.8821e-01, -1.5387e-01, -2.7130e-01,  5.4372e-01,  7.2660e-01],</span></a>
<a class="sourceLine" id="cb45-155" data-line-number="155"><span class="co">#&gt;         [ 4.2673e-01, -5.1439e-01,  6.7241e-01, -2.2079e-01,  4.4144e-01,</span></a>
<a class="sourceLine" id="cb45-156" data-line-number="156"><span class="co">#&gt;          -8.6878e-01,  5.9312e-01,  3.7624e-02, -3.5291e-01, -5.4810e-01],</span></a>
<a class="sourceLine" id="cb45-157" data-line-number="157"><span class="co">#&gt;         [-3.2306e-01, -1.2890e+00,  5.9507e-01, -8.6414e-01,  2.0963e+00,</span></a>
<a class="sourceLine" id="cb45-158" data-line-number="158"><span class="co">#&gt;          -7.0459e-01, -3.9541e-01,  3.4197e-01, -4.0710e-03,  4.6265e-01],</span></a>
<a class="sourceLine" id="cb45-159" data-line-number="159"><span class="co">#&gt;         [-1.3478e+00, -4.1975e-01, -3.7824e-01,  2.6787e+00, -6.0352e-01,</span></a>
<a class="sourceLine" id="cb45-160" data-line-number="160"><span class="co">#&gt;           9.8328e-01, -7.8180e-01, -1.0321e+00,  8.8281e-01, -1.0461e-01],</span></a>
<a class="sourceLine" id="cb45-161" data-line-number="161"><span class="co">#&gt;         [ 2.7198e+00, -1.4207e+00,  6.6662e-01, -7.2796e-01, -1.4472e+00,</span></a>
<a class="sourceLine" id="cb45-162" data-line-number="162"><span class="co">#&gt;           5.0870e-01,  2.7811e-02, -1.8390e-01, -3.0498e-01, -7.9730e-01],</span></a>
<a class="sourceLine" id="cb45-163" data-line-number="163"><span class="co">#&gt;         [ 2.0499e-01, -1.4901e+00, -1.0418e+00,  1.7478e-01, -3.4975e-02,</span></a>
<a class="sourceLine" id="cb45-164" data-line-number="164"><span class="co">#&gt;          -3.1510e-01, -7.7895e-01,  2.8745e+00, -3.0569e-01,  3.6625e-01],</span></a>
<a class="sourceLine" id="cb45-165" data-line-number="165"><span class="co">#&gt;         [ 4.4238e+00, -2.8872e+00,  9.3004e-01,  1.7180e-01, -1.2156e+00,</span></a>
<a class="sourceLine" id="cb45-166" data-line-number="166"><span class="co">#&gt;           8.0985e-01, -7.8977e-02, -1.7985e+00,  3.4585e-01, -1.7968e+00],</span></a>
<a class="sourceLine" id="cb45-167" data-line-number="167"><span class="co">#&gt;         [ 1.3774e+00, -1.1985e+00,  1.6984e+00,  9.6535e-01, -1.1847e+00,</span></a>
<a class="sourceLine" id="cb45-168" data-line-number="168"><span class="co">#&gt;           1.6558e-01,  3.5373e-01, -1.1125e+00,  2.6874e-01, -1.9591e+00],</span></a>
<a class="sourceLine" id="cb45-169" data-line-number="169"><span class="co">#&gt;         [-1.4483e+00,  9.4671e-01,  4.3281e-01, -1.3504e-01, -7.9817e-01,</span></a>
<a class="sourceLine" id="cb45-170" data-line-number="170"><span class="co">#&gt;          -3.4784e-01, -9.5641e-01,  9.0392e-01,  1.2296e+00,  6.2921e-01],</span></a>
<a class="sourceLine" id="cb45-171" data-line-number="171"><span class="co">#&gt;         [-1.2396e+00,  2.2696e+00, -3.8555e-01,  1.5065e-01, -7.4453e-01,</span></a>
<a class="sourceLine" id="cb45-172" data-line-number="172"><span class="co">#&gt;           8.4066e-02, -5.4862e-04, -1.4012e-01,  5.9549e-01, -2.5350e-01],</span></a>
<a class="sourceLine" id="cb45-173" data-line-number="173"><span class="co">#&gt;         [-1.7944e+00,  3.0241e-01, -5.2784e-01, -4.9973e-01,  8.7231e-01,</span></a>
<a class="sourceLine" id="cb45-174" data-line-number="174"><span class="co">#&gt;          -6.4315e-01, -8.1029e-01,  1.5847e+00,  1.3244e-01,  7.4525e-01],</span></a>
<a class="sourceLine" id="cb45-175" data-line-number="175"><span class="co">#&gt;         [-2.8294e-01,  1.7816e-01, -3.7291e-01,  2.1598e+00, -9.4734e-01,</span></a>
<a class="sourceLine" id="cb45-176" data-line-number="176"><span class="co">#&gt;           1.0114e+00, -5.0824e-01, -1.2849e+00,  4.5710e-01, -9.0987e-01],</span></a>
<a class="sourceLine" id="cb45-177" data-line-number="177"><span class="co">#&gt;         [-7.8757e-01, -4.4467e-01,  6.6353e-01, -5.5224e-01, -1.6245e-01,</span></a>
<a class="sourceLine" id="cb45-178" data-line-number="178"><span class="co">#&gt;          -5.9033e-01,  8.4956e-02,  1.5716e+00, -2.9244e-01,  3.7864e-01],</span></a>
<a class="sourceLine" id="cb45-179" data-line-number="179"><span class="co">#&gt;         [-1.7389e+00,  1.1484e+00, -6.6717e-01, -1.0438e-02, -1.2760e-01,</span></a>
<a class="sourceLine" id="cb45-180" data-line-number="180"><span class="co">#&gt;           1.0584e-01, -6.0197e-01,  2.6480e-01,  7.9318e-01,  6.3942e-01],</span></a>
<a class="sourceLine" id="cb45-181" data-line-number="181"><span class="co">#&gt;         [-5.7751e-01, -6.4384e-01, -3.9230e-01, -9.5214e-01,  1.6688e-01,</span></a>
<a class="sourceLine" id="cb45-182" data-line-number="182"><span class="co">#&gt;          -3.6310e-01, -1.3429e+00,  3.4312e+00,  2.3366e-01,  9.4845e-01],</span></a>
<a class="sourceLine" id="cb45-183" data-line-number="183"><span class="co">#&gt;         [-6.0143e-01, -1.7209e+00, -1.1494e+00, -1.5037e-01,  1.0337e+00,</span></a>
<a class="sourceLine" id="cb45-184" data-line-number="184"><span class="co">#&gt;           4.3592e-01, -3.9708e-01,  1.6140e+00, -5.6450e-01,  1.6807e+00],</span></a>
<a class="sourceLine" id="cb45-185" data-line-number="185"><span class="co">#&gt;         [ 1.9210e-02, -1.9223e+00,  3.8673e-01, -6.4197e-01,  1.1106e-01,</span></a>
<a class="sourceLine" id="cb45-186" data-line-number="186"><span class="co">#&gt;           1.8099e-01,  2.2784e+00, -5.9888e-01, -1.7361e-01,  2.6417e-02],</span></a>
<a class="sourceLine" id="cb45-187" data-line-number="187"><span class="co">#&gt;         [-6.2876e-01, -1.1091e+00,  3.7508e+00, -2.3448e-01, -5.8493e-01,</span></a>
<a class="sourceLine" id="cb45-188" data-line-number="188"><span class="co">#&gt;          -1.1884e+00,  7.8236e-01, -1.3223e+00,  4.7385e-01, -1.0343e+00],</span></a>
<a class="sourceLine" id="cb45-189" data-line-number="189"><span class="co">#&gt;         [-6.7678e-01, -1.7449e+00, -8.4556e-01, -1.1483e-01,  6.9988e-01,</span></a>
<a class="sourceLine" id="cb45-190" data-line-number="190"><span class="co">#&gt;          -8.7946e-02, -1.1765e+00,  2.2800e+00, -2.6902e-01,  1.5336e+00],</span></a>
<a class="sourceLine" id="cb45-191" data-line-number="191"><span class="co">#&gt;         [-8.5717e-01, -1.2230e-01, -4.1116e-01, -6.0145e-01,  3.7790e-01,</span></a>
<a class="sourceLine" id="cb45-192" data-line-number="192"><span class="co">#&gt;           6.3771e-01, -7.4120e-01, -6.7263e-01,  1.0677e+00,  4.3252e-01],</span></a>
<a class="sourceLine" id="cb45-193" data-line-number="193"><span class="co">#&gt;         [-1.0534e+00, -2.4691e+00, -9.4150e-01,  1.9233e-01,  2.7386e+00,</span></a>
<a class="sourceLine" id="cb45-194" data-line-number="194"><span class="co">#&gt;           3.5948e-02, -3.9486e-01, -4.7238e-01,  1.9305e-01,  1.2211e+00],</span></a>
<a class="sourceLine" id="cb45-195" data-line-number="195"><span class="co">#&gt;         [-1.7862e+00,  5.2157e-01, -3.0508e-01, -6.5667e-01, -1.7478e-01,</span></a>
<a class="sourceLine" id="cb45-196" data-line-number="196"><span class="co">#&gt;          -7.3403e-01, -1.2763e+00,  3.0680e+00,  3.5662e-01,  8.3210e-01],</span></a>
<a class="sourceLine" id="cb45-197" data-line-number="197"><span class="co">#&gt;         [-2.0383e-01, -1.4847e+00, -1.1861e+00,  1.8072e+00, -2.5057e-01,</span></a>
<a class="sourceLine" id="cb45-198" data-line-number="198"><span class="co">#&gt;           1.0957e+00,  5.9455e-01, -2.8468e-01,  3.5113e-03,  2.4995e-01],</span></a>
<a class="sourceLine" id="cb45-199" data-line-number="199"><span class="co">#&gt;         [-2.2450e-01, -2.1181e+00,  8.5168e-01, -1.3561e+00,  1.1374e+00,</span></a>
<a class="sourceLine" id="cb45-200" data-line-number="200"><span class="co">#&gt;          -8.7003e-01,  2.3503e+00, -1.2551e-01, -7.3214e-01,  3.2295e-01],</span></a>
<a class="sourceLine" id="cb45-201" data-line-number="201"><span class="co">#&gt;         [-1.5622e+00,  2.9467e+00,  2.3842e-01, -4.1466e-03, -4.9765e-01,</span></a>
<a class="sourceLine" id="cb45-202" data-line-number="202"><span class="co">#&gt;          -4.4173e-01, -2.7219e-01, -4.8037e-01,  4.2418e-01, -6.4807e-01],</span></a>
<a class="sourceLine" id="cb45-203" data-line-number="203"><span class="co">#&gt;         [ 3.2558e-01, -7.5724e-01, -3.3548e-01,  2.5756e+00, -1.2860e+00,</span></a>
<a class="sourceLine" id="cb45-204" data-line-number="204"><span class="co">#&gt;           8.6770e-01, -1.5311e+00, -6.9928e-01,  7.0599e-01, -8.3875e-01],</span></a>
<a class="sourceLine" id="cb45-205" data-line-number="205"><span class="co">#&gt;         [-1.0576e+00, -6.6676e-01,  2.5216e-01, -6.8168e-01,  3.6745e-01,</span></a>
<a class="sourceLine" id="cb45-206" data-line-number="206"><span class="co">#&gt;          -3.0722e-01,  2.5982e+00, -1.0629e+00, -2.4848e-02, -4.1388e-02],</span></a>
<a class="sourceLine" id="cb45-207" data-line-number="207"><span class="co">#&gt;         [-9.5286e-01,  1.9398e-02,  1.0449e-01, -6.3894e-01,  5.5353e-01,</span></a>
<a class="sourceLine" id="cb45-208" data-line-number="208"><span class="co">#&gt;          -1.4634e-01, -1.2423e-01, -1.7330e-01,  6.2860e-01,  4.6942e-01],</span></a>
<a class="sourceLine" id="cb45-209" data-line-number="209"><span class="co">#&gt;         [-8.5543e-01, -5.4686e-01, -6.9736e-01,  2.6438e+00, -1.5634e+00,</span></a>
<a class="sourceLine" id="cb45-210" data-line-number="210"><span class="co">#&gt;           1.1179e+00, -9.4266e-01,  6.2668e-01,  7.7778e-01,  5.8852e-03],</span></a>
<a class="sourceLine" id="cb45-211" data-line-number="211"><span class="co">#&gt;         [-2.2078e+00,  1.6199e+00, -2.2630e-01,  1.2530e-01, -4.7198e-01,</span></a>
<a class="sourceLine" id="cb45-212" data-line-number="212"><span class="co">#&gt;           1.0774e-02,  2.9402e-01, -4.8964e-01,  7.1760e-01, -1.9049e-01],</span></a>
<a class="sourceLine" id="cb45-213" data-line-number="213"><span class="co">#&gt;         [-9.1752e-01, -3.7215e-01, -4.7562e-01, -1.3739e+00,  2.1835e+00,</span></a>
<a class="sourceLine" id="cb45-214" data-line-number="214"><span class="co">#&gt;          -5.7999e-01,  2.8290e-01,  1.0376e-01, -1.9788e-01,  9.8971e-01],</span></a>
<a class="sourceLine" id="cb45-215" data-line-number="215"><span class="co">#&gt;         [-1.1180e+00,  5.1952e-01, -3.8798e-01,  2.1147e-01, -8.3925e-02,</span></a>
<a class="sourceLine" id="cb45-216" data-line-number="216"><span class="co">#&gt;           2.4309e-01, -3.1124e-01,  1.8244e-01,  3.3479e-01,  2.1253e-01],</span></a>
<a class="sourceLine" id="cb45-217" data-line-number="217"><span class="co">#&gt;         [-1.9207e+00,  1.1729e+00, -6.8848e-01,  1.9835e-02, -4.4881e-01,</span></a>
<a class="sourceLine" id="cb45-218" data-line-number="218"><span class="co">#&gt;          -2.0059e-01, -2.0613e-02,  6.3143e-01,  3.2693e-01,  3.8787e-01],</span></a>
<a class="sourceLine" id="cb45-219" data-line-number="219"><span class="co">#&gt;         [ 8.8183e-01, -1.0252e+00,  7.2092e-01, -8.0147e-01, -3.8480e-01,</span></a>
<a class="sourceLine" id="cb45-220" data-line-number="220"><span class="co">#&gt;           5.0632e-01,  1.9679e+00, -1.0822e+00,  4.3187e-02, -8.1902e-01],</span></a>
<a class="sourceLine" id="cb45-221" data-line-number="221"><span class="co">#&gt;         [-1.3331e+00, -1.7548e+00,  5.5981e-02, -4.4007e-01,  1.5412e+00,</span></a>
<a class="sourceLine" id="cb45-222" data-line-number="222"><span class="co">#&gt;          -9.3015e-01, -4.2966e-01,  8.7212e-01,  7.0002e-02,  2.2018e+00]],</span></a>
<a class="sourceLine" id="cb45-223" data-line-number="223"><span class="co">#&gt;        grad_fn=&lt;AddmmBackward&gt;)</span></a>
<a class="sourceLine" id="cb45-224" data-line-number="224"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted)</a>
<a class="sourceLine" id="cb45-225" data-line-number="225"><span class="co">#&gt; tensor([8, 9, 0, 1, 4, 7, 4, 2, 6, 7, 8, 0, 8, 2, 8, 4, 7, 8, 9, 7, 8, 6, 4, 1,</span></a>
<a class="sourceLine" id="cb45-226" data-line-number="226"><span class="co">#&gt;         4, 2, 2, 4, 4, 7, 0, 1, 9, 2, 8, 7, 8, 2, 6, 0, 0, 6, 3, 8, 8, 9, 1, 4,</span></a>
<a class="sourceLine" id="cb45-227" data-line-number="227"><span class="co">#&gt;         0, 6, 1, 0, 0, 0, 0, 8, 1, 7, 7, 1, 4, 6, 0, 7, 0, 3, 6, 8, 7, 1, 3, 2,</span></a>
<a class="sourceLine" id="cb45-228" data-line-number="228"><span class="co">#&gt;         4, 4, 4, 2, 6, 4, 1, 7, 2, 6, 6, 0, 1, 2, 8, 4, 5, 6, 7, 8, 4, 0, 1, 2,</span></a>
<a class="sourceLine" id="cb45-229" data-line-number="229"><span class="co">#&gt;         3, 4, 8, 6])</span></a></code></pre></div>
<div id="printing-output-size" class="section level3">
<h3 class="hasAnchor">
<a href="#printing-output-size" class="anchor"></a>Printing output size</h3>
<p>This produces a 100x10 matrix because each iteration has a batch size of 100 and each prediction across the 10 classes, with the largest number indicating the likely number it is predicting.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb46-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb46-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb46-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb46-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb46-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb46-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb46-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb46-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb46-14" data-line-number="14">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb46-15" data-line-number="15">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'OUTPUTS'</span>)</a>
<a class="sourceLine" id="cb46-16" data-line-number="16">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(outputs<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb46-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb46-18" data-line-number="18">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb46-19" data-line-number="19">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb46-20" data-line-number="20">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb46-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb46-22" data-line-number="22"><span class="co">#&gt; [1] "OUTPUTS"</span></a>
<a class="sourceLine" id="cb46-23" data-line-number="23"><span class="co">#&gt; torch.Size([100, 10])</span></a>
<a class="sourceLine" id="cb46-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb46-25" data-line-number="25"><span class="co">#&gt; torch.Size([100])</span></a></code></pre></div>
<blockquote>
<p>The <code>predicted</code> and <code>output</code> tensors have the same number of 1D members. It is obvious because <code>predicted</code> is calculated from the <code>output</code> maximum values.</p>
</blockquote>
</div>
<div id="printing-one-output" class="section level3">
<h3 class="hasAnchor">
<a href="#printing-one-output" class="anchor"></a>Printing one output</h3>
<p>This would be a 1x10 matrix where the largest number is what the model thinks the image is. Here we can see that in the tensor, position 7 has the largest number, indicating the model thinks the image is 7.</p>
<pre><code>number 0: -0.4181
number 1: -1.0784
...
number 7: 2.9352</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb48-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb48-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb48-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb48-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb48-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb48-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb48-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb48-14" data-line-number="14">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb48-15" data-line-number="15">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'OUTPUTS'</span>)</a>
<a class="sourceLine" id="cb48-16" data-line-number="16">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(outputs[<span class="dv">1</span>])    <span class="co"># show first tensor of 100</span></a>
<a class="sourceLine" id="cb48-17" data-line-number="17">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(outputs[<span class="dv">100</span>])   <span class="co"># show last tensor of 100</span></a>
<a class="sourceLine" id="cb48-18" data-line-number="18">    }</a>
<a class="sourceLine" id="cb48-19" data-line-number="19">    <span class="co"># Get predictions from the maximum value for 100 tensors</span></a>
<a class="sourceLine" id="cb48-20" data-line-number="20">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb48-21" data-line-number="21">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb48-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb48-23" data-line-number="23"><span class="co">#&gt; [1] "OUTPUTS"</span></a>
<a class="sourceLine" id="cb48-24" data-line-number="24"><span class="co">#&gt; Warning in `[.torch.Tensor`(outputs, 1): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb48-25" data-line-number="25"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb48-26" data-line-number="26"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb48-27" data-line-number="27"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb48-28" data-line-number="28"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb48-29" data-line-number="29"><span class="co">#&gt; tensor([-0.3456, -1.1338, -0.6001, -0.0253, -0.0149, -0.3315, -1.1867,  2.8442,</span></a>
<a class="sourceLine" id="cb48-30" data-line-number="30"><span class="co">#&gt;         -0.1047,  0.8866], grad_fn=&lt;SelectBackward&gt;)</span></a>
<a class="sourceLine" id="cb48-31" data-line-number="31"><span class="co">#&gt; Warning in `[.torch.Tensor`(outputs, 100): Incorrect number of dimensions</span></a>
<a class="sourceLine" id="cb48-32" data-line-number="32"><span class="co">#&gt; supplied. The number of supplied arguments, (not counting any NULL,</span></a>
<a class="sourceLine" id="cb48-33" data-line-number="33"><span class="co">#&gt; tf$newaxis or np$newaxis) must match thenumber of dimensions in the tensor,</span></a>
<a class="sourceLine" id="cb48-34" data-line-number="34"><span class="co">#&gt; unless an all_dims() was supplied (this will produce an error in the</span></a>
<a class="sourceLine" id="cb48-35" data-line-number="35"><span class="co">#&gt; future)</span></a>
<a class="sourceLine" id="cb48-36" data-line-number="36"><span class="co">#&gt; tensor([-1.3331, -1.7548,  0.0560, -0.4401,  1.5412, -0.9302, -0.4297,  0.8721,</span></a>
<a class="sourceLine" id="cb48-37" data-line-number="37"><span class="co">#&gt;          0.0700,  2.2018], grad_fn=&lt;SelectBackward&gt;)</span></a>
<a class="sourceLine" id="cb48-38" data-line-number="38"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted)</a>
<a class="sourceLine" id="cb48-39" data-line-number="39"><span class="co">#&gt; tensor([8, 9, 0, 1, 4, 7, 4, 2, 6, 7, 8, 0, 8, 2, 8, 4, 7, 8, 9, 7, 8, 6, 4, 1,</span></a>
<a class="sourceLine" id="cb48-40" data-line-number="40"><span class="co">#&gt;         4, 2, 2, 4, 4, 7, 0, 1, 9, 2, 8, 7, 8, 2, 6, 0, 0, 6, 3, 8, 8, 9, 1, 4,</span></a>
<a class="sourceLine" id="cb48-41" data-line-number="41"><span class="co">#&gt;         0, 6, 1, 0, 0, 0, 0, 8, 1, 7, 7, 1, 4, 6, 0, 7, 0, 3, 6, 8, 7, 1, 3, 2,</span></a>
<a class="sourceLine" id="cb48-42" data-line-number="42"><span class="co">#&gt;         4, 4, 4, 2, 6, 4, 1, 7, 2, 6, 6, 0, 1, 2, 8, 4, 5, 6, 7, 8, 4, 0, 1, 2,</span></a>
<a class="sourceLine" id="cb48-43" data-line-number="43"><span class="co">#&gt;         3, 4, 8, 6])</span></a></code></pre></div>
</div>
<div id="printing-prediction-output" class="section level3">
<h3 class="hasAnchor">
<a href="#printing-prediction-output" class="anchor"></a>Printing prediction output</h3>
<p>Because our output is of size 100 (our batch size), our prediction size would also of the size 100.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb49-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb49-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb49-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb49-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb49-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb49-14" data-line-number="14">    <span class="co"># Get predictions from the maximum value for a batch</span></a>
<a class="sourceLine" id="cb49-15" data-line-number="15">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb49-16" data-line-number="16">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb49-17" data-line-number="17">    </a>
<a class="sourceLine" id="cb49-18" data-line-number="18">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb49-19" data-line-number="19">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'PREDICTION'</span>)</a>
<a class="sourceLine" id="cb49-20" data-line-number="20">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb49-21" data-line-number="21">    }</a>
<a class="sourceLine" id="cb49-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb49-23" data-line-number="23"><span class="co">#&gt; [1] "PREDICTION"</span></a>
<a class="sourceLine" id="cb49-24" data-line-number="24"><span class="co">#&gt; torch.Size([100])</span></a></code></pre></div>
</div>
<div id="print-prediction-value" class="section level3">
<h3 class="hasAnchor">
<a href="#print-prediction-value" class="anchor"></a>Print prediction value</h3>
<p>We are printing our prediction which as verified above, should be digit 7.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb50-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb50-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb50-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">    </a>
<a class="sourceLine" id="cb50-11" data-line-number="11">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb50-12" data-line-number="12">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb50-13" data-line-number="13">    </a>
<a class="sourceLine" id="cb50-14" data-line-number="14">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb50-15" data-line-number="15">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb50-16" data-line-number="16">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb50-17" data-line-number="17">    </a>
<a class="sourceLine" id="cb50-18" data-line-number="18">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb50-19" data-line-number="19">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'PREDICTION'</span>)</a>
<a class="sourceLine" id="cb50-20" data-line-number="20">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb50-21" data-line-number="21">    }</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb50-23" data-line-number="23"><span class="co">#&gt; [1] "PREDICTION"</span></a>
<a class="sourceLine" id="cb50-24" data-line-number="24"><span class="co">#&gt; tensor(7)</span></a></code></pre></div>
</div>
<div id="print-prediction-label-and-label-size" class="section level3">
<h3 class="hasAnchor">
<a href="#print-prediction-label-and-label-size" class="anchor"></a>Print prediction, label and label size</h3>
<p>We are trying to show what we are predicting and the actual values. In this case, weâ€™re predicting the right value 7!</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb51-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb51-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb51-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb51-10" data-line-number="10">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb51-11" data-line-number="11">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb51-12" data-line-number="12">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb51-13" data-line-number="13">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb51-14" data-line-number="14">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb51-15" data-line-number="15">    </a>
<a class="sourceLine" id="cb51-16" data-line-number="16">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb51-17" data-line-number="17">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'PREDICTION'</span>)</a>
<a class="sourceLine" id="cb51-18" data-line-number="18">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb51-19" data-line-number="19">        </a>
<a class="sourceLine" id="cb51-20" data-line-number="20">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'LABEL SIZE'</span>)</a>
<a class="sourceLine" id="cb51-21" data-line-number="21">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(labels<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb51-22" data-line-number="22"></a>
<a class="sourceLine" id="cb51-23" data-line-number="23">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'LABEL FOR IMAGE 0'</span>)</a>
<a class="sourceLine" id="cb51-24" data-line-number="24">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(labels[<span class="dv">1</span>]<span class="op">$</span><span class="kw">item</span>())  <span class="co"># extract the scalar part only</span></a>
<a class="sourceLine" id="cb51-25" data-line-number="25">    }</a>
<a class="sourceLine" id="cb51-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb51-27" data-line-number="27"><span class="co">#&gt; [1] "PREDICTION"</span></a>
<a class="sourceLine" id="cb51-28" data-line-number="28"><span class="co">#&gt; tensor(7)</span></a>
<a class="sourceLine" id="cb51-29" data-line-number="29"><span class="co">#&gt; [1] "LABEL SIZE"</span></a>
<a class="sourceLine" id="cb51-30" data-line-number="30"><span class="co">#&gt; torch.Size([100])</span></a>
<a class="sourceLine" id="cb51-31" data-line-number="31"><span class="co">#&gt; [1] "LABEL FOR IMAGE 0"</span></a>
<a class="sourceLine" id="cb51-32" data-line-number="32"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
</div>
<div id="print-second-prediction-and-ground-truth" class="section level3">
<h3 class="hasAnchor">
<a href="#print-second-prediction-and-ground-truth" class="anchor"></a>Print second prediction and ground truth</h3>
<p>It should be the digit 2.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb52-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb52-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb52-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb52-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb52-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb52-10" data-line-number="10">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb52-11" data-line-number="11">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb52-12" data-line-number="12">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb52-13" data-line-number="13">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb52-14" data-line-number="14">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb52-15" data-line-number="15">    </a>
<a class="sourceLine" id="cb52-16" data-line-number="16">    <span class="cf">if</span> (iter_test <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb52-17" data-line-number="17">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'PREDICTION'</span>)</a>
<a class="sourceLine" id="cb52-18" data-line-number="18">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(predicted[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb52-19" data-line-number="19">        </a>
<a class="sourceLine" id="cb52-20" data-line-number="20">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'LABEL SIZE'</span>)</a>
<a class="sourceLine" id="cb52-21" data-line-number="21">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(labels<span class="op">$</span><span class="kw">size</span>())</a>
<a class="sourceLine" id="cb52-22" data-line-number="22"></a>
<a class="sourceLine" id="cb52-23" data-line-number="23">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">'LABEL FOR IMAGE 0'</span>)</a>
<a class="sourceLine" id="cb52-24" data-line-number="24">        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(labels[<span class="dv">1</span>]<span class="op">$</span><span class="kw">item</span>())</a>
<a class="sourceLine" id="cb52-25" data-line-number="25">    }</a>
<a class="sourceLine" id="cb52-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb52-27" data-line-number="27"><span class="co">#&gt; [1] "PREDICTION"</span></a>
<a class="sourceLine" id="cb52-28" data-line-number="28"><span class="co">#&gt; tensor(7)</span></a>
<a class="sourceLine" id="cb52-29" data-line-number="29"><span class="co">#&gt; [1] "LABEL SIZE"</span></a>
<a class="sourceLine" id="cb52-30" data-line-number="30"><span class="co">#&gt; torch.Size([100])</span></a>
<a class="sourceLine" id="cb52-31" data-line-number="31"><span class="co">#&gt; [1] "LABEL FOR IMAGE 0"</span></a>
<a class="sourceLine" id="cb52-32" data-line-number="32"><span class="co">#&gt; [1] 7</span></a></code></pre></div>
</div>
<div id="print-accuracy" class="section level3">
<h3 class="hasAnchor">
<a href="#print-accuracy" class="anchor"></a>Print accuracy</h3>
<p>Now we know what each object represents, we can understand how we arrived at our accuracy numbers.</p>
<p>One last thing to note is that <code>correct.item()</code> has this syntax is because correct is a PyTorch tensor and to get the value to compute with total which is an integer, we need to do this.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># Iterate through test dataset</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2">iter_test &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb53-3" data-line-number="3">iter_test_dataset &lt;-<span class="st"> </span>builtins<span class="op">$</span><span class="kw">enumerate</span>(test_loader) <span class="co"># convert to iterator</span></a>
<a class="sourceLine" id="cb53-4" data-line-number="4"><span class="cf">for</span> (test_obj <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/iterate">iterate</a></span>(iter_test_dataset)) {</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">    iter_test &lt;-<span class="st"> </span>iter_test <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb53-6" data-line-number="6">    <span class="co"># Load images to a Torch Variable</span></a>
<a class="sourceLine" id="cb53-7" data-line-number="7">    images &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb53-8" data-line-number="8">    labels &lt;-<span class="st"> </span>test_obj[[<span class="dv">2</span>]][[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb53-9" data-line-number="9">    images &lt;-<span class="st"> </span>images<span class="op">$</span><span class="kw">view</span>(<span class="op">-</span>1L, 28L<span class="op">*</span>28L)<span class="op">$</span><span class="kw">requires_grad_</span>()</a>
<a class="sourceLine" id="cb53-10" data-line-number="10">    <span class="co"># Forward pass only to get logits/output</span></a>
<a class="sourceLine" id="cb53-11" data-line-number="11">    outputs =<span class="st"> </span><span class="kw">model</span>(images)</a>
<a class="sourceLine" id="cb53-12" data-line-number="12">    <span class="co"># Get predictions from the maximum value</span></a>
<a class="sourceLine" id="cb53-13" data-line-number="13">    .predicted =<span class="st"> </span>torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(outputs<span class="op">$</span>data, 1L)</a>
<a class="sourceLine" id="cb53-14" data-line-number="14">    predicted &lt;-<span class="st"> </span>.predicted[1L]</a>
<a class="sourceLine" id="cb53-15" data-line-number="15">    <span class="co"># Total number of labels</span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16">    total =<span class="st"> </span>total <span class="op">+</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">size</span>(0L)</a>
<a class="sourceLine" id="cb53-17" data-line-number="17">    <span class="co"># Total correct predictions</span></a>
<a class="sourceLine" id="cb53-18" data-line-number="18">    correct =<span class="st"> </span>correct <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>((predicted<span class="op">$</span><span class="kw">numpy</span>() <span class="op">==</span><span class="st"> </span>labels<span class="op">$</span><span class="kw">numpy</span>()))</a>
<a class="sourceLine" id="cb53-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb53-20" data-line-number="20">accuracy =<span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span>correct <span class="op">/</span><span class="st"> </span>total</a>
<a class="sourceLine" id="cb53-21" data-line-number="21"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(accuracy)</a>
<a class="sourceLine" id="cb53-22" data-line-number="22"><span class="co">#&gt; [1] 82.75</span></a></code></pre></div>
</div>
</div>
<div id="saving-pytorch-model" class="section level2">
<h2 class="hasAnchor">
<a href="#saving-pytorch-model" class="anchor"></a>Saving PyTorch model</h2>
<p>This is how you save your model. Feel free to just change <code>save_model = TRUE</code> to save your model</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">save_model =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="cf">if</span> (save_model) {</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">    <span class="co"># Saves only parameters</span></a>
<a class="sourceLine" id="cb54-4" data-line-number="4">    torch<span class="op">$</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/save">save</a></span>(model<span class="op">$</span><span class="kw">state_dict</span>(), <span class="st">'awesome_model.pkl'</span>)</a>
<a class="sourceLine" id="cb54-5" data-line-number="5">}</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-datasets">Load datasets</a></li>
      <li><a href="#defining-epochs">Defining epochs</a></li>
      <li><a href="#create-iterable-objects-training-and-testing-dataset">Create iterable objects: training and testing dataset</a></li>
      <li><a href="#building-the-model">Building the model</a></li>
      <li><a href="#train-the-model-and-test-per-epoch">Train the model and test per epoch</a></li>
      <li><a href="#break-down-accuracy-calculation">Break down accuracy calculation</a></li>
      <li><a href="#saving-pytorch-model">Saving PyTorch model</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alfonso R. Reyes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
